# Hive Server Docker Compose Configuration
# 
# Quick start:
#   docker-compose up -d
#
# With custom configuration:
#   cp .env.example .env
#   # Edit .env with your settings
#   docker-compose up -d

version: '3.8'

services:
  hive-server:
    build:
      context: .
      dockerfile: Dockerfile
    image: hive-server:latest
    container_name: hive-server
    restart: unless-stopped
    ports:
      - "${PORT:-3000}:3000"
    environment:
      - NODE_ENV=production
      - PORT=3000
      - JWT_SECRET=${JWT_SECRET:?JWT_SECRET is required}
      - DATABASE_PATH=/app/data/users.db
      - VAULTS_PATH=/app/data/vaults
      - BACKUPS_PATH=/app/data/backups
      - ALLOWED_ORIGINS=${ALLOWED_ORIGINS:-http://localhost:3000}
      - ADMIN_PASSWORD=${ADMIN_PASSWORD:-}
    volumes:
      - hive-data:/app/data
    healthcheck:
      test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost:3000/api/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

volumes:
  hive-data:
    name: hive-server-data

